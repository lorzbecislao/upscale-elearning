import{e as E,l as U,o as f,b as z,w as S,d as t,a as n,u as o,c as g,i as D,t as h,F as w,k as T,g as G,q as J,r as c,f as K,h as Q}from"./app-b19efd51.js";import{_ as W}from"./Pagination-87e350d7.js";import{_ as X,a as Y,r as Z,T as ee}from"./FlashNotificationsFrontEnd-eb33766e.js";import"./SearchSelect.vue_vue_type_style_index_0_lang-65f8e845.js";import{_ as F}from"./SelectInput-1a332e1b.js";import{_ as te}from"./Toggle-0636531a.js";import{_ as se}from"./Modal-8b7fb719.js";import{_ as ae}from"./PrimaryButton-3a9c59a6.js";import{_ as oe}from"./SecondaryButton-74dd022e.js";import{T as V}from"./TextInput-9f73cf15.js";import{I as le}from"./InformationCircleIcon-e16ef61f.js";import"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                                  */import"./CheckCircleIcon-8759a125.js";import"./v4-4a60fe23.js";import"./XIcon-1b05f6c1.js";import"./use-resolve-button-type-871855d6.js";import"./dialog-4910b468.js";import"./transition-ff246cea.js";const re=t("h5",{class:"font-heading font-bold text-black-darkest"}," Update Student ",-1),ne=["onSubmit"],ie={class:"pt-6"},ue={class:"pt-6"},me={class:"pt-6 grid grid-cols-2 gap-6"},de={class:"pt-6"},pe=["value"],ce={class:"pt-6 flex justify-end gap-3"},_e={__name:"EditStudentModal",props:{open:Boolean,student:Object,programs:Array},emits:["close","refreshDataTable"],setup(y,{emit:$}){const s=y,e=E({student_number:s.student?s.student.student_number:null,email:s.student?s.student.email:null,first_name:s.student?s.student.first_name:null,last_name:s.student?s.student.last_name:null,program_id:s.student?s.student.program_id:null});U(()=>s.student,m=>{m&&(e.student_number=m.student_number,e.email=m.email,e.first_name=m.first_name,e.last_name=m.last_name,e.program_id=m.program_id)});function v(){e.student_number=s.student.student_number,e.email=s.student.email,e.first_name=s.student.first_name,e.last_name=s.student.last_name,e.program_id=s.student.program_id,$("close")}const d=()=>{e.post(route("admin.students.update",s.student.id),{onSuccess:()=>{v(),e.student_number="",e.email="",e.first_name="",e.last_name="",e.program_id="",$("refreshDataTable")}})};return(m,i)=>(f(),z(se,{open:y.open,onClose:v},{content:S(()=>[re,t("form",{onSubmit:G(d,["prevent"])},[t("div",ie,[n(V,{max:8,min:8,modelValue:o(e).student_number,"onUpdate:modelValue":i[0]||(i[0]=l=>o(e).student_number=l),required:!0,errors:o(e).errors?o(e).errors.student_number:[],label:"Student Number"},null,8,["modelValue","errors"])]),t("div",ue,[n(V,{modelValue:o(e).email,"onUpdate:modelValue":i[1]||(i[1]=l=>o(e).email=l),errors:o(e).errors?o(e).errors.email:[],label:"Email Address",required:!0},null,8,["modelValue","errors"])]),t("div",me,[n(V,{modelValue:o(e).first_name,"onUpdate:modelValue":i[2]||(i[2]=l=>o(e).first_name=l),errors:o(e).errors?o(e).errors.first_name:[],label:"First Name",required:!0},null,8,["modelValue","errors"]),n(V,{modelValue:o(e).last_name,"onUpdate:modelValue":i[3]||(i[3]=l=>o(e).last_name=l),errors:o(e).errors?o(e).errors.last_name:[],label:"Last Name",required:!0},null,8,["modelValue","errors"])]),t("div",de,[n(F,{id:"select-program",modelValue:o(e).program_id,"onUpdate:modelValue":i[4]||(i[4]=l=>o(e).program_id=l),value:o(e).program_id},{default:S(()=>[(f(!0),g(w,null,D(y.programs,(l,b)=>(f(),g("option",{key:b,value:l.value},h(l.label),9,pe))),128))]),_:1},8,["modelValue","value"])]),t("div",ce,[n(oe,{type:"button",onClick:v},{default:S(()=>[T(" Cancel ")]),_:1}),n(ae,{class:"!px-8",type:"submit"},{default:S(()=>[T(" Update ")]),_:1})])],40,ne)]),_:1},8,["open"]))}},fe={class:"px-4 sm:px-6 lg:px-8"},ve={class:"mt-8 flow-root"},ge={class:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},xe={class:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8"},he={class:"min-w-full divide-y divide-gray-300"},ye=t("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Student Number ",-1),be=t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"Name ",-1),Se=t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"Email ",-1),$e=t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Program",-1),Ve=t("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"Status ",-1),we={scope:"col",class:"px-3 py-3.5 text-left items-center flex text-sm font-semibold text-gray-900"},Ce={class:"mt-0.5 ml-1"},ke=t("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-0"},[t("span",{class:"sr-only"},"Edit")],-1),De={class:"divide-y divide-gray-200"},Te={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-bold text-primary sm:pl-0"},Ne={class:"whitespace-nowrap px-3 py-4 text-sm text-primary"},Ee={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},Ue={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},Fe={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},Ie={class:"whitespace-nowrap px-3 items-center text-sm text-gray-500"},qe=["value"],Ae={class:"relative whitespace-nowrap inline-flex items-center py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-0"},st={__name:"DataTable",props:{programs:Array},setup(y,{expose:$}){J(()=>{p()});const s=c(null),e=c("id"),v=c("asc"),d=c([]),m=c(!1),i=c(!1),l=c(null),b=c(!1),N={icon:"check",header:null},p=(a=1)=>{axios.get("/admin/users/students/data-table",{params:{page:a,search:s.value,sort_column:e.value,sort_direction:v.value}}).then(r=>{d.value=r.data}).catch(r=>{console.error(r)})};function I(a){s.value=a,p(1)}U([s,e,v],()=>{p()},{immediate:!0}),$({handleSearch:I,loadData:p});function q(a){if(a){const r=a.match(/page=(\d+)/),k=r?r[1]:1;p(k)}}function A(a){p(a)}function B(a){l.value=a,m.value=!0}function P(a){l.value=a,i.value=!0}function M(){axios.post(route("admin.students.delete",l.value.id)).then(a=>{m.value=!1,b.value=!0,N.header="Student deleted successfully",p(1)}).catch(a=>{console.error("Delete error:",a)})}const x=E({id:null,forumStatus:null});function j(a){x.id=a.id,x.patch(route("admin.students.toggleStatus",a.id),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{p()}})}const L=[{id:1,value:1,label:"View Only"},{id:2,value:2,label:"Full Access"}],C=c();function O(a){x.id=a,x.forumStatus=C.value,x.post(route("admin.students.update-forum-status",x.id),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{p()}})}return(a,r)=>{const k=K("tooltip");return f(),g(w,null,[t("div",fe,[t("div",ve,[t("div",ge,[t("div",xe,[t("table",he,[t("thead",null,[t("tr",null,[ye,be,Se,$e,Ve,t("th",we,[T(" Forum Status "),Q((f(),g("button",Ce,[n(le,{class:"w-5 h-5 text-medium-gray"})])),[[k,{content:"Full Access = Can post, like, and reply"}]])]),ke])]),t("tbody",De,[(f(!0),g(w,null,D(d.value.data,(u,H)=>(f(),g("tr",{key:H},[t("td",Te,h(u.student_number),1),t("td",Ne,h(u.full_name),1),t("td",Ee,h(u.email),1),t("td",Ue,h(u.program.initial),1),t("td",Fe,[n(te,{value:!!u.user.status,type:"success",onToggleValue:_=>j(u)},null,8,["value","onToggleValue"])]),t("td",Ie,[n(F,{id:"select-forum-status",modelValue:C.value,"onUpdate:modelValue":r[0]||(r[0]=_=>C.value=_),value:u.forum_status,onChange:_=>O(u.id)},{default:S(()=>[(f(),g(w,null,D(L,(_,R)=>t("option",{key:R,value:_.value},h(_.label),9,qe)),64))]),_:2},1032,["modelValue","value","onChange"])]),t("td",Ae,[n(o(Z),{onClick:_=>P(u),class:"mx-1 text-medium-gray w-5 h-5 cursor-pointer"},null,8,["onClick"]),n(ee,{onClick:_=>B(u),class:"text-medium-gray cursor-pointer"},null,8,["onClick"])])]))),128))])])])])])]),n(W,{class:"mt-4 px-2",current_page:d.value.current_page,last_page:d.value.last_page,next_page_url:d.value.next_page_url,prev_page_url:d.value.prev_page_url,path:d.value.path,pagination:d.value,search:s.value,sort_column:e.value,sort_direction:v.value,onEmitPage:q,onEmitSpecificPage:A,total_pages:d.value.total},null,8,["current_page","last_page","next_page_url","prev_page_url","path","pagination","search","sort_column","sort_direction","total_pages"]),n(X,{open:m.value,onClose:r[1]||(r[1]=u=>m.value=!1),onHandleSubmit:M},null,8,["open"]),n(_e,{open:i.value,student:l.value,programs:y.programs,onClose:r[2]||(r[2]=u=>i.value=!1),onRefreshDataTable:r[3]||(r[3]=u=>p(1))},null,8,["open","student","programs"]),n(Y,{infos:N,icon:"info",state:b.value,onClose:r[4]||(r[4]=u=>b.value=!1)},null,8,["state"])],64)}}};export{st as default};
